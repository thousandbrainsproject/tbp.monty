# @package _global_
# Unsupervised inference with distant agent on distinct objects.
# Uses NoResetEvidenceGraphLM for continuous evidence accumulation without resets.

defaults:
  - /environment/object_sampler: random_rotation
  - override /logging: defaults
  - override /monty: benchmark_evidence_sota
  - override /agent_config: patch_view_habitat
  - override /environment: ycb_distinct

_target_: tbp.monty.frameworks.experiments.object_recognition_experiments.MontyObjectRecognitionExperiment

config:
  model_name_or_path: ${vars.pretrained_dir}/surf_agent_1lm_10distinctobj/pretrained/
  n_eval_epochs: 10
  max_eval_steps: 100
  logging:
    python_log_level: WARNING
    monty_log_level: BASIC
    monty_handlers:
      - ${monty.class:tbp.monty.frameworks.loggers.monty_handlers.BasicCSVStatsHandler}
      - ${monty.class:tbp.monty.frameworks.loggers.monty_handlers.ReproduceEpisodeHandler}
    wandb_handlers:
      - ${monty.class:tbp.monty.frameworks.loggers.wandb_handlers.BasicWandbTableStatsHandler}
      - ${monty.class:tbp.monty.frameworks.loggers.wandb_handlers.BasicWandbChartStatsHandler}
    wandb_group: benchmark_experiments
    output_dir: ${path.expanduser:${oc.env:MONTY_LOGS}/projects/monty_runs}
    run_name: unsupervised_inference_distinctobj_dist_agent
  monty_config:
    monty_class: ${monty.class:tbp.monty.frameworks.models.no_reset_evidence_matching.MontyForNoResetEvidenceGraphMatching}
    monty_args:
      min_eval_steps: 100
    learning_module_configs:
      learning_module_0:
        learning_module_class: ${monty.class:tbp.monty.frameworks.models.no_reset_evidence_matching.NoResetEvidenceGraphLM}
        learning_module_args:
          evidence_threshold_config: all
    sensor_module_configs:
      sensor_module_1:
        sensor_module_args:
          save_raw_obs: false
  eval_env_interface_class: ${monty.class:tbp.monty.frameworks.environments.embodied_data.InformedEnvironmentInterface}
