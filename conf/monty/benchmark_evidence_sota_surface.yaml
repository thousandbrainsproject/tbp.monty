# @package config.monty_config
# Benchmark evidence SOTA surface config
#
# Surface agent variant for benchmark evaluation. Uses:
# - Evidence matching monty class
# - Curvature-informed surface goal state driven motor policy
# - Surface sensor module (is_surface_sm: true)
# - Evidence LM with lower max_nneighbors for faster runtime

defaults:
  - monty_class: evidence_matching
  - monty_args: defaults
  - motor_system: cur_informed_surface_goal_state_driven
  - connectivity: patch_view_single_lm

# Surface sensor modules with benchmark-specific settings
sensor_module_configs:
  sensor_module_0:
    sensor_module_class: ${monty.class:tbp.monty.frameworks.models.sensor_modules.HabitatSM}
    sensor_module_args:
      is_surface_sm: true
      sensor_module_id: patch
      features:
        - pose_vectors
        - pose_fully_defined
        - on_object
        - object_coverage
        - min_depth
        - mean_depth
        - hsv
        - principal_curvatures
        - principal_curvatures_log
      delta_thresholds:
        on_object: 0
        n_steps: 20
        hsv: [0.1, 0.1, 0.1]
        pose_vectors: ${np.list_eval:[np.pi / 4, np.pi * 2, np.pi * 2]}
        principal_curvatures_log: [2, 2]
        distance: 0.01
      save_raw_obs: false
  sensor_module_1:
    sensor_module_class: ${monty.class:tbp.monty.frameworks.models.sensor_modules.Probe}
    sensor_module_args:
      sensor_module_id: view_finder
      save_raw_obs: false

# Learning module with lower max_nneighbors for benchmarks
learning_module_configs:
  learning_module_0:
    learning_module_class: ${monty.class:tbp.monty.frameworks.models.evidence_matching.learning_module.EvidenceGraphLM}
    learning_module_args:
      max_match_distance: 0.01
      x_percent_threshold: 20
      evidence_threshold_config: 80%
      max_graph_size: 0.3
      num_model_voxels_per_dim: 100
      gsg_class: ${monty.class:tbp.monty.frameworks.models.goal_state_generation.EvidenceGoalStateGenerator}
      gsg_args:
        goal_tolerances:
          location: 0.015
        elapsed_steps_factor: 10
        min_post_goal_success_steps: 5
        x_percent_scale_factor: 0.75
        desired_object_distance: 0.025
      hypotheses_updater_args:
        max_nneighbors: 5
      feature_weights:
        patch:
          hsv: ${np.array:[1, 0.5, 0.5]}
          pose_vectors: ${np.ones:3}
          principal_curvatures_log: ${np.ones:2}
      tolerances:
        patch:
          hsv: ${np.array:[0.1, 0.2, 0.2]}
          principal_curvatures_log: ${np.ones:2}
