# @package _global_
# Tutorial: Your first Monty experiment
#
# To test your env and help you familiarize yourself with the code, we'll run the simplest possible
# experiment. We'll use a model with a single learning module as specified in
# monty_config. We'll also skip evaluation, train for a single epoch for a single step,
# and only train on a single object, as specified in config and train_env_interface_args.

# The order of the defaults matters. The defaults are applied in order, from top to bottom.
defaults:
  - /environment/object_sampler: predefined
  - override /mode: pretrain
  - override /logging: pretrain
  - override /agent_config: patch_view_habitat
  - override /monty: patch_and_view_learning

# The top-level _target_ is the experiment we want to run.
_target_: tbp.monty.frameworks.experiments.pretraining_experiments.MontySupervisedObjectPretrainingExperiment
# We override some of the config values we got from the pre-defined defaults.
config:
  do_eval: false
  max_train_steps: 1
  n_train_epochs: 1
  # We override the run_name in config.logging to be specific to our experiment.
  logging:
    run_name: first_experiment
  train_env_interface_class: ${monty.class:tbp.monty.frameworks.environments.embodied_data.EnvironmentInterfacePerObject}
  # We override the train_env_interface_args to be specific to our experiment.
  train_env_interface_args:
    object_names:
      - mug
    # We use the Predefined object initializer to initialize the object.
    object_init_sampler:
      # Since this is a _target_, Hydra will instantiate this class using the _target_ and any
      # additional arguments you provide.
      _target_: tbp.monty.frameworks.environments.object_init_samplers.Predefined
