# @package _global_
# Disk Learning Control Experiment (3D sensor baseline)
#
# Usage: python run.py experiment=2d_sm/learning/disk_learning_control
#
# Control experiment using standard 3D sensor (HabitatSM) for comparison with 2D sensor.

defaults:
  - override /config: supervised_pretraining
  - override /logging: pretrain
  - override /train_env: disk_objects
  - override /monty/motor_system_config: naive_scan_spiral

# Experiment class for instantiation
_target_: tbp.monty.frameworks.experiments.pretraining_experiments.MontySupervisedObjectPretrainingExperiment

# Config overrides
config:
  n_train_epochs: 3
  logging:
    output_dir: ${path.expanduser:${oc.env:MONTY_MODELS}/2d_sensor}
    python_log_level: INFO
    run_name: disk_learning_control
  monty_config:
    monty_args:
      num_exploratory_steps: 500
    motor_system_config:
      motor_system_args:
        policy_class: ${monty.class:tbp.monty.frameworks.models.motor_policies.NaiveScanPolicy}
        policy_args:
          use_goal_state_driven_actions: false
          fixed_amount: 1
          switch_frequency: 1
          min_perc_on_obj: 0.25
          good_view_percentage: 0.5
          desired_object_distance: 0.03
          agent_id: ${monty.agent_id:agent_id_0}
          action_sampler_class: ${monty.class:tbp.monty.frameworks.actions.action_samplers.ConstantSampler}
          action_sampler_args:
            rotation_degrees: 5.0
            actions:
              - ${monty.class:tbp.monty.frameworks.actions.actions.LookUp}
              - ${monty.class:tbp.monty.frameworks.actions.actions.LookDown}
              - ${monty.class:tbp.monty.frameworks.actions.actions.TurnLeft}
              - ${monty.class:tbp.monty.frameworks.actions.actions.TurnRight}
              - ${monty.class:tbp.monty.frameworks.actions.actions.SetAgentPose}
              - ${monty.class:tbp.monty.frameworks.actions.actions.SetSensorRotation}
    learning_module_configs:
      learning_module_0:
        learning_module_args:
          k: 10
          tolerance: ${np.array:[0.0001, 0.0001, 0.0001]}
          graph_delta_thresholds:
            patch:
              distance: 0.001
              pose_vectors: ${np.list_eval:[np.pi / 8, np.pi * 2, np.pi * 2]}
              principal_curvatures_log: [1, 1]
              hsv: [0.1, 1, 1]
  env_interface_config:
    env_init_args:
      data_path: ${path.expanduser:${oc.env:MONTY_DATA}/compositional_objects}
  train_env_interface_class: ${monty.class:tbp.monty.frameworks.environments.embodied_data.InformedEnvironmentInterface}
  train_env_interface_args:
    object_init_sampler:
      _target_: tbp.monty.frameworks.config_utils.make_env_interface_configs.PredefinedObjectInitializer
      positions:
        - [0.0, 1.5, 0.0]
        - [-0.03, 1.5, 0.0]
        - [0.03, 1.5, 0.0]
      rotations: [[0.0, 0.0, 0.0]]

